<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover">
  <title>Temas Salvos — direito.love</title>
  <link rel="stylesheet" href="styles.css">
  <style>
    /* Ajustes extras para mobile */
    @media (max-width: 768px) {
      .tema-salvo {
        padding: 16px;
      }
      .tema-salvo h2 {
        font-size: 16px;
        margin-bottom: 10px;
      }
      .option-btn {
        font-size: 15px;
        padding: 14px;
        border-radius: 8px;
      }
      .salvos-container {
        gap: 18px;
      }
      .app-header h1 {
        font-size: 15px;
      }
      .settings-btn {
        font-size: 20px;
        padding: 6px;
      }
    }

    /* Safe area padding para iOS */
    body {
      padding-bottom: env(safe-area-inset-bottom);
    }
  </style>
</head>
<body>
  <!-- Cabeçalho fixo -->
  <header class="app-header">
    <h1>Temas Salvos</h1>
    <a href="index.html" class="settings-btn" aria-label="Voltar para página inicial">⬅</a>
  </header>

  <!-- Conteúdo -->
  <main class="salvos-container" id="salvos-container" role="main">
    <p>Carregando temas salvos...</p>
  </main>

  <!-- Toast -->
  <div id="toast" class="toast" role="status" aria-live="polite"></div>

  <script>
    // ================================
    // Inicializar tema (claro / escuro / automático)
    // ================================
    (function initTheme() {
      const savedTheme = localStorage.getItem("theme") || "auto";
      if (savedTheme === "dark") {
        document.body.classList.add("dark");
      } else if (savedTheme === "auto" && window.matchMedia("(prefers-color-scheme: dark)").matches) {
        document.body.classList.add("dark");
      }
    })();

    // ================================
    // Snackbar (toast moderno)
    // ================================
    let toastTimeout;
    function showToast(message) {
      const toast = document.getElementById("toast");
      toast.textContent = message;

      toast.classList.remove("show");
      clearTimeout(toastTimeout);

      setTimeout(() => {
        toast.classList.add("show");
      }, 50);

      const duracao = message.length > 40 ? 3500 : 1800;
      toastTimeout = setTimeout(() => {
        toast.classList.remove("show");
      }, duracao);
    }

    // ================================
    // Carregar temas salvos
    // ================================
    const container = document.getElementById("salvos-container");
    const salvos = JSON.parse(localStorage.getItem("temasSalvos")) || [];

    container.innerHTML = "";

    if (salvos.length === 0) {
      container.innerHTML = "<p>Nenhum tema salvo ainda.</p>";
    } else {
      // aviso se atingir limite
      if (salvos.length >= 10) {
        const aviso = document.createElement("p");
        aviso.textContent = "⚠️ Você já atingiu o limite de 10 temas salvos. O mais antigo será substituído.";
        aviso.style.fontSize = "13px";
        aviso.style.color = "var(--muted)";
        aviso.style.marginBottom = "12px";
        container.appendChild(aviso);
      }

      salvos.forEach((item, index) => {
        const div = document.createElement("div");
        div.className = "tema-salvo";

        // título do tema
        const titulo = document.createElement("h2");
        titulo.textContent = `📌 ${item.tema}`;
        titulo.style.color = "var(--text)";
        div.appendChild(titulo);

        // descrição
        const desc = document.createElement("p");
        desc.textContent = "Escolha um dos prompts para copiar:";
        div.appendChild(desc);

        // botões das opções
        item.opcoes.forEach(opcao => {
          const btn = document.createElement("button");
          btn.className = "option-btn";
          btn.textContent = opcao.nome;
          btn.setAttribute("aria-label", `Copiar prompt de ${opcao.nome}`);
          btn.addEventListener("click", () => {
            navigator.clipboard.writeText(opcao.prompt).then(() => {
              showToast(`✅ Prompt de "${opcao.nome}" copiado!`);
            });
          });
          div.appendChild(btn);
        });

        // espaçamento entre blocos
        if (index < salvos.length - 1) {
          div.style.marginBottom = "20px";
        }

        container.appendChild(div);
      });
    }
  </script>
</body>
</html>
