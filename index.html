<!DOCTYPE html>
<html lang="pt-br">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>direito.love</title>

  <!-- Tema dinâmico -->
  <script>
  (function () {
    try {
      var prefs = JSON.parse(localStorage.getItem('prefs') || '{}');
      var t = prefs.theme || 'auto';
      var eff = (t === 'auto')
        ? (window.matchMedia('(prefers-color-scheme: dark)').matches ? 'dark' : 'light')
        : t;
      document.documentElement.setAttribute('data-theme', eff);
      var meta = document.querySelector('meta[name="theme-color"][data-live]');
      if (!meta) {
        meta = document.createElement('meta');
        meta.setAttribute('name', 'theme-color');
        meta.setAttribute('data-live', '1');
        document.head.appendChild(meta);
      }
      meta.setAttribute('content', eff === 'dark' ? '#15181c' : '#e9eaee');
    } catch (e) {}
  })();
  </script>

  <!-- PWA -->
  <link rel="manifest" href="manifest.webmanifest">
  <meta name="theme-color" content="#e9eaee" data-live>
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="default">

  <!-- Favicon genérico -->
  <link rel="icon" href="favicon.ico">

  <!-- CSS -->
  <link rel="stylesheet" href="styles.css">
</head>
<body>
  <!-- Topbar -->
  <header class="topbar" role="banner">
    <div class="container nav">
      <div class="brand" aria-label="direito.love">
        <span class="logo" role="img" aria-label="Logo">💚</span>
        <strong class="title">direito.love</strong>
      </div>
      <nav class="actions" aria-label="Ações principais">
        <a class="iconbtn" href="arquivo.html" aria-label="Histórico">🗃️</a>
        <button class="iconbtn" id="btn-new" aria-label="Novo tema">➕</button>
        <button class="iconbtn" id="btn-settings" aria-label="Configurações">☰</button>
      </nav>
    </div>
  </header>

  <!-- App principal -->
  <main class="container app" role="main">
    <section id="chat" class="chat" aria-label="Conversa">
      <div class="input-bubble">
        <input type="text" id="tema" placeholder="Digite um tema para gerar o prompt...">
        <div class="row">
          <button class="btn" id="copiar" style="display:none">📋 Copiar</button>
          <button class="btn" id="abrir" style="display:none">💬 Abrir IA</button>
        </div>
      </div>
      <div id="resultado" class="info-msg"></div>
      <div id="objetivos"></div>
    </section>
  </main>

  <!-- Rodapé -->
  <footer class="container footer" role="contentinfo">
    <small>💚 direito.love — seu assistente de estudo jurídico</small>
  </footer>

  <!-- Modal Configurações -->
  <dialog id="settings-modal" class="settings-modal" aria-labelledby="settings-title">
    <form method="dialog" class="settings-card">
      <h3 id="settings-title">⚙️ Configurações</h3>
      <div class="settings-row">
        <div class="settings-info">
          <strong>Feedback Tátil</strong>
          <p>Vibração leve ao copiar prompts</p>
        </div>
        <label class="switch">
          <input type="checkbox" id="opt-haptics"/>
          <span class="slider"></span>
        </label>
      </div>
      <div class="settings-row">
        <div class="settings-info">
          <strong>Tema</strong>
          <p>Escolha claro, escuro ou automático</p>
        </div>
        <div class="theme-options">
          <button class="chip theme-btn" data-value="light" role="radio">🌞 Claro</button>
          <button class="chip theme-btn" data-value="dark" role="radio">🌙 Escuro</button>
          <button class="chip theme-btn" data-value="auto" role="radio">⚡ Auto</button>
        </div>
      </div>
      <div class="settings-row">
        <div class="settings-info">
          <strong>Lembrete diário</strong>
          <p>Notificação para revisar 1 tema por dia</p>
        </div>
        <label class="switch">
          <input type="checkbox" id="opt-daily"/>
          <span class="slider"></span>
        </label>
      </div>
      <div class="settings-row link-only">
        <a class="btn mini" href="politica.html" target="_blank" rel="noopener">
          🔒 Política de Privacidade
        </a>
      </div>
      <div class="settings-actions">
        <button class="btn" value="cancel">Fechar</button>
      </div>
    </form>
  </dialog>

  <!-- JS -->
  <script src="app.js" defer></script>
  <script>
    if ('serviceWorker' in navigator) {
      navigator.serviceWorker.register('sw.js').catch(console.error);
    }
  </script>
</body>
</html>
