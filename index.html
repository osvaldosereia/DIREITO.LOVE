<!doctype html>
<html lang="pt-BR">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
  <title>direito.love ‚Äî Gerar Prompts</title>
  <meta name="theme-color" content="#0c4160" />

  <!-- PWA -->
  <link rel="manifest" href="./manifest.json">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="default">

  <style>
    :root{
      --bg:#f6f7fb; --surface:#ffffff; --ink:#0f172a; --muted:#6b7280; --border:#e5e7eb;
      --primary:#0c4160; --primary-2:#0e567c;
      --radius:22px; --elev-1:0 8px 30px rgba(15,23,42,.08);
      --fs-h:clamp(22px,4vw,42px); --fs-b:clamp(14px,1.8vw,16px);
    }
    *{ box-sizing:border-box }
    html,body{ height:100% }
    body{
      margin:0;
      background:
        radial-gradient(1200px 800px at 0% -20%, #eaf7f5 0%, transparent 60%),
        radial-gradient(800px 600px at 110% 10%, #f1f6fb 0%, transparent 55%),
        var(--bg);
      color:var(--ink);
      font-family: Inter, system-ui, -apple-system, Segoe UI, Roboto, Arial;
      font-size:var(--fs-b);
    }
    .wrap{ max-width:960px; margin:0 auto; padding:28px 16px 96px }
    .top{ display:flex; justify-content:space-between; align-items:center; margin-bottom:18px }
    .brand{ display:flex; align-items:center; gap:12px }
    .logo{ display:block; width:auto; height:44px; border-radius:10px } /* UMA √öNICA LOGO PNG */

    .tabs{ display:flex; gap:8px; margin:8px 0 18px }
    .tab{ all:unset; border:1px solid var(--border); background:#fff; padding:8px 14px; border-radius:999px; cursor:pointer; font-weight:700 }
    .tab[aria-selected="true"]{ background:var(--primary); color:#fff; border-color:transparent }

    .card{ background:var(--surface); border:1px solid var(--border); border-radius:var(--radius); box-shadow:var(--elev-1); padding:22px }
    .title{ font-weight:700; font-size:var(--fs-h); line-height:1.05; margin:0 0 6px }
    .subtitle{ color:var(--muted); margin:0 0 16px }

    .row{ display:grid; gap:12px; grid-template-columns:1fr }
    .field{
      width:100%; border:1px solid var(--border); background:#f4f7fb;
      border-radius:16px; padding:14px 16px; outline:none; color:var(--ink);
    }
    .field:focus{ border-color:#b9c6d1; box-shadow:0 0 0 3px rgba(14,86,124,.12) }

    .btn{ all:unset; display:inline-flex; align-items:center; justify-content:center; gap:8px; padding:12px 16px; border-radius:14px; font-weight:700; cursor:pointer }
    .btn-primary{ background:var(--primary); color:#fff }
    .btn-primary:hover{ background:var(--primary-2) }
    .btn-ghost{ border:1px solid var(--border); background:#fff; color:#0f172a }

    .thinking{ display:none; align-items:center; gap:10px; margin-top:16px; color:#0a2430 }
    .dot{ width:8px; height:8px; border-radius:999px; background:var(--primary); opacity:.6; animation:bounce .9s infinite }
    .dot:nth-child(2){ animation-delay:.15s }
    .dot:nth-child(3){ animation-delay:.3s }
    @keyframes bounce{ 0%,80%,100%{ transform:translateY(0); opacity:.3 } 40%{ transform:translateY(-6px); opacity:1 } }

    .result{ display:none; margin-top:18px }
    .lead{ font-weight:600; margin:0 0 10px }
    .copygrid{ display:grid; gap:10px; grid-template-columns:1fr }
    .copy-btn{
      all:unset; display:flex; align-items:center; justify-content:space-between;
      padding:14px 16px; border:1px solid var(--border); border-radius:14px; background:#fff; cursor:pointer
    }
    .copy-btn .lbl{ font-weight:700 }
    .copy-btn .hint{ color:var(--muted); font-size:.95em }
    .copy-btn:active{ transform:translateY(1px) }

    .divider{ height:1px; background:var(--border); margin:18px 0 }
    .again{ display:flex; justify-content:center; margin-top:16px }

    .ai-footer{ padding:18px 0 28px }
    .ai-links{ display:flex; flex-wrap:wrap; gap:12px; justify-content:center }
    .ai-link{ all:unset; display:inline-flex; align-items:center; justify-content:center; background:var(--primary); color:#fff; padding:6px 10px; border-radius:999px; font-size:12px; font-weight:600; opacity:.95; cursor:pointer; transition:opacity .2s }
    .ai-link:hover{ opacity:1 }
  </style>
</head>
<body>
  <div class="wrap">
    <header class="top">
      <div class="brand">
        <img class="logo" src="./icons/logo.png" alt="direito.love" />
      </div>
      <a class="btn btn-ghost" href="https://www.instagram.com/osvaldosereiajr/" target="_blank" rel="noopener">Instagram</a>
    </header>

    <nav class="tabs" role="tablist" aria-label="Navega√ß√£o">
      <button class="tab" id="tab-gerar" aria-controls="panel-gerar" aria-selected="true">Gerar</button>
      <button class="tab" id="tab-arquivo" aria-controls="panel-arquivo" aria-selected="false">Arquivo</button>
    </nav>

    <section id="panel-gerar" class="card" role="tabpanel" aria-labelledby="tab-gerar">
      <h1 class="title">Gerar Prompts</h1>
      <p class="subtitle">Digite apenas o tema que eu fa√ßo a m√°gica</p>

      <div class="row">
        <input id="tema" class="field" type="text" placeholder="Ex.: Dano moral por negativa√ß√£o indevida" aria-label="Tema" />
        <button id="gerar" class="btn btn-primary">GERAR PROMPTS</button>
      </div>

      <div id="thinking" class="thinking" aria-live="polite">
        <span class="sr-only">Processando‚Ä¶</span>
        <div class="dot"></div><div class="dot"></div><div class="dot"></div>
        <span>pensando‚Ä¶</span>
      </div>

      <section id="result" class="result" aria-live="polite">
        <p class="lead">Criei 4 prompts com as novas regras (Planalto direto e Google News).</p>
        <div class="copygrid">
          <button class="copy-btn" id="copy-aprender"><span class="lbl">APRENDER</span> <span class="hint">copiar</span></button>
          <button class="copy-btn" id="copy-treinar"><span class="lbl">TREINAR</span> <span class="hint">copiar</span></button>
          <button class="copy-btn" id="copy-noticias"><span class="lbl">NOT√çCIAS</span> <span class="hint">copiar</span></button>
          <button class="copy-btn" id="copy-casoreal"><span class="lbl">CASO REAL</span> <span class="hint">copiar</span></button>
        </div>
        <div class="divider"></div>
        <div class="again">
          <button id="reset" type="button" class="btn btn-primary">Nova Pesquisa</button>
        </div>
      </section>
    </section>

    <section id="panel-arquivo" class="card" role="tabpanel" aria-labelledby="tab-arquivo" hidden>
      <h2 class="title" style="font-size:26px">Arquivo ‚Äî √∫ltimas 50 pesquisas</h2>
      <p class="subtitle">Clique em "Copiar" para enviar o prompt ao clipboard.</p>
      <div id="book-list" class="list"></div>
    </section>
  </div>

  <footer class="ai-footer" aria-label="Ferramentas de IA">
    <div class="ai-links">
      <a class="ai-link" href="https://chat.openai.com/" target="_blank" rel="noopener">GPT</a>
      <a class="ai-link" href="https://gemini.google.com/" target="_blank" rel="noopener">Gemini</a>
      <a class="ai-link" href="https://www.perplexity.ai/" target="_blank" rel="noopener">Perplexity</a>
      <a class="ai-link" href="https://www.phind.com/" target="_blank" rel="noopener">Phind</a>
      <a class="ai-link" href="https://notebooklm.google.com/" target="_blank" rel="noopener">NotebookLM</a>
      <a class="ai-link" href="https://consensus.app/" target="_blank" rel="noopener">Consensus</a>
    </div>
  </footer>

  <script>
    // ===== Abas =====
    const tabGerar = document.getElementById('tab-gerar');
    const tabArq = document.getElementById('tab-arquivo');
    const panelGerar = document.getElementById('panel-gerar');
    const panelArq = document.getElementById('panel-arquivo');
    function selectTab(which){
      const gerar = which === 'gerar';
      tabGerar.setAttribute('aria-selected', gerar);
      tabArq.setAttribute('aria-selected', !gerar);
      panelGerar.hidden = !gerar;
      panelArq.hidden = gerar;
      if(!gerar) renderBookAll();
    }
    tabGerar.addEventListener('click', () => selectTab('gerar'));
    tabArq.addEventListener('click', () => selectTab('arquivo'));

    // ===== Helpers =====
    const qPlus = (s) => encodeURIComponent(s).replace(/%20/g, '+');
    const makeNewsURL = (frase) => `https://news.google.com/search?q=${qPlus(frase)}`;

    // Pesquisa Google geral (com 3 sites aleat√≥rios ‚Äî mantido)
    const SITES_POOL = ['JusBrasil','Jus','JurisWay','Conjur','√Çmbito Jur√≠dico','Pergunte Direito','Dicion√°rio Direito','Conte√∫do Jur√≠dico','Dicion√°rio Informal','LegJur','Planalto'];
    function pickSites(n = 3){
      const arr = [...SITES_POOL];
      for (let i = arr.length - 1; i > 0; i--) { const j = Math.floor(Math.random()*(i+1)); [arr[i],arr[j]]=[arr[j],arr[i]]; }
      return arr.slice(0,n);
    }
    function makeSearchURL(tema, extras=[], picks=pickSites(3)){
      const q = [tema, ...picks, ...extras].join(' ').trim();
      return `https://www.google.com/search?q=${encodeURIComponent(q)}`;
    }

    // CTA
    const CTA = `\n\n**üíö [direito.love](https://direito.love)**`;

    // Regras globais atualizadas
    const RegrasGlobais = `
**Links ‚Äî regra geral:**
- Use **Google/Google News** para orientar o leitor √†s fontes.
- **Exce√ß√£o obrigat√≥ria:** em **Base legal essencial**, traga **link direto do Planalto** para o **artigo/lei exata** (sem Google intermedi√°rio).
- Em buscas do Google News, **a frase pesquisada deve aparecer linkada** (sem exibir URL longa).
`;

    // ===== Templates =====
    const Templates = {
      aprender: (tema) => {
        const mainSearch = makeSearchURL(tema, ['STJ','STF'], pickSites());
        return `Voc√™ √© um professor universit√°rio de Direito.

**Objetivo:** explicar **${tema}** com profundidade, de forma did√°tica.
${RegrasGlobais}

**üîé Pesquisa principal (Google):**
${mainSearch}

## üß© Conceito direto (4‚Äì6 linhas)

## üìú Base legal essencial
- Liste **artigo(s)** e **lei(s)** pertinentes com **link direto para o Planalto** na **se√ß√£o exata** (artigo, inciso, ¬ß).
- Explique conte√∫do normativo e aplica√ß√£o.
- Formato esperado: \`art. X da Lei Y ‚Äî (Planalto: link direto)\`

## ‚öñÔ∏è Quadro comparativo
| Instituto | Quando se aplica | Exemplo r√°pido |
|----------|------------------|----------------|

## üß† Racioc√≠nio jur√≠dico passo a passo
1. Situa√ß√£o | 2. Pressupostos | 3. Doutrina | 4. STJ/STF | 5. Consequ√™ncias | 6. Medidas.

## üíº Exemplos pr√°ticos (3 mini-casos)

## üßØ Erros comuns (3) + üß® Pegadinhas (2)

## ‚úÖ Checklist (5 itens)

## üìö Mini gloss√°rio (5 termos)

## üîé Buscas prontas (5)
Ap√≥s escrever **Exemplos pr√°ticos**, **extraia 5 palavras/express√µes** desse trecho e **crie 5 buscas no Google News**, cada uma:
- **t√≠tulo linkado** com a **pr√≥pria frase** (n√£o exiba a URL longa);
- **objetivo da busca** em 1 linha.

**Formato (exemplo):**
- [<frase extra√≠da A>](${makeNewsURL('<frase extra√≠da A>')}) ‚Äî objetivo em 1 linha.
- [<frase extra√≠da B>](${makeNewsURL('<frase extra√≠da B>')}) ‚Äî objetivo em 1 linha.
- (total 5 itens)
${CTA}`;
      },

      treinar: (tema) => {
        const mainSearch = makeSearchURL(tema, ['quest√µes OAB','STJ','STF'], pickSites());
        return `Voc√™ √© um elaborador de quest√µes para OAB e gradua√ß√£o.

**Tema:** ${tema}
${RegrasGlobais}

**üîé Pesquisa principal (Google):**
${mainSearch}

## Quest√µes (1 a 10)
1. **Q1) Enunciado...**
---
2. **Q2) Enunciado...**
---
... (at√© Q10)

## Gabarito Comentado
- Q1) Letra C ‚Äî justificativa breve (se citar lei/precedente, **use link direto do Planalto** em Base legal e valide o restante por leitura).${CTA}`;
      },

      noticias: (tema) => {
        return `Voc√™ √© um curador de atualidades jur√≠dicas.

**Nova estrat√©gia (NOT√çCIAS):** Com base no tema **${tema}**, **identifique os eixos informacionais mais recorrentes** (jurisprud√™ncia recente, PLs, decis√µes STF/STJ, estat√≠sticas, impacto econ√¥mico/social, casos emblem√°ticos, posi√ß√µes de √≥rg√£os, tend√™ncias setoriais, etc.) e **crie 10 buscas espec√≠ficas no Google News** ‚Äî **todas altamente relevantes** ao tema.

**Regras:**
- Cada item deve trazer **t√≠tulo da busca linkado** (a **pr√≥pria frase** linkada para o Google News) + **breve objetivo** (1 linha).
- Siga o **modelo de link**: \`https://news.google.com/search?q=intelig√™ncia+artificial\`.
- **N√£o exibir** a URL longa; **linke a frase**.
- Evite itens redundantes; varie recortes (jur√≠dico, pr√°tico, setorial, regional, temporal).

**Formato (10 itens):**
1) [<busca muito relevante 1>](https://news.google.com/search?q=<busca+1>) ‚Äî objetivo em 1 linha.
2) [<busca muito relevante 2>](https://news.google.com/search?q=<busca+2>) ‚Äî objetivo em 1 linha.
...
10) [<busca muito relevante 10>](https://news.google.com/search?q=<busca+10>) ‚Äî objetivo em 1 linha.
${CTA}`;
      },

      casoreal: (tema) => {
        const mainSearch = makeSearchURL(tema, ['caso real','jurisprud√™ncia','decis√£o','2023..2025'], pickSites());
        return `Voc√™ √© um analista jur√≠dico. Encontre **at√© 5 casos reais** sobre **${tema}** (√∫ltimos 36 meses).

${RegrasGlobais}

**üîé Pesquisa principal (Google):**
${mainSearch}

# Casos reais (at√© 5)
1. T√≠tulo ‚Äî Data | Site sugerido
   - Resumo factual (3‚Äì4 linhas).
   - Coment√°rio jur√≠dico (5‚Äì6 linhas).
   - Link (Google ‚Äî mesmo para todos): ${mainSearch}
2. ...
3. ...
4. ...
5. ...

## üîé Buscas prontas (5)
Ap√≥s escrever os **Casos reais**, **extraia 5 palavras/express√µes** usadas nesses casos e **crie 5 buscas no Google News**:
- **t√≠tulo linkado** com a **pr√≥pria frase** (sem mostrar URL longa);
- **objetivo** (1 linha).

**Formato (exemplo):**
- [<frase do caso A>](${makeNewsURL('<frase do caso A>')}) ‚Äî objetivo em 1 linha.
- [<frase do caso B>](${makeNewsURL('<frase do caso B>')}) ‚Äî objetivo em 1 linha.
- (total 5 itens)
${CTA}`;
      }
    };

    // ===== Estado & elementos =====
    let current = { tema:"", prompts:{ aprender:"", treinar:"", noticias:"", casoreal:"" } };
    const el = {
      tema: document.getElementById('tema'),
      gerar: document.getElementById('gerar'),
      thinking: document.getElementById('thinking'),
      result: document.getElementById('result'),
      copyA: document.getElementById('copy-aprender'),
      copyT: document.getElementById('copy-treinar'),
      copyN: document.getElementById('copy-noticias'),
      copyC: document.getElementById('copy-casoreal'),
      reset: document.getElementById('reset'),
      book: document.getElementById('book-list')
    };

    // ===== Persist√™ncia (at√© 50 entradas) =====
    const BOOK_KEY = 'book_data_v7_btnreset_planalto_news10';
    function loadBook(){ try { return JSON.parse(localStorage.getItem(BOOK_KEY) || '[]') || []; } catch { return []; } }
    function saveBook(arr){ try { localStorage.setItem(BOOK_KEY, JSON.stringify(arr)); } catch {} }
    function pushEntry(obj){
      let data = loadBook();
      if(!Array.isArray(data)) data = [];
      data.unshift(obj);
      if(data.length > 50) data = data.slice(0,50);
      saveBook(data);
    }

    function renderBookAll(){
      const data = loadBook();
      el.book.innerHTML = '';
      if(!data.length){
        el.book.innerHTML = '<div class="item"><div class="meta"><div class="obj">Arquivo vazio</div><div class="tema">Voc√™ ainda n√£o gerou nenhum prompt.</div></div></div>';
        return;
      }
      const frag = document.createDocumentFragment();
      data.forEach(({objetivo, tema, prompt})=>{
        const div = document.createElement('div');
        div.className = 'item';
        div.innerHTML = `<div class="meta"><div class="obj">${objetivo||'‚Äî'}</div><div class="tema">${(tema||'').slice(0,300)}</div></div>
        <button class="btn btn-ghost" data-prompt>Copiar</button>`;
        const btn = div.querySelector('[data-prompt]');
        btn.addEventListener('click', async ()=>{
          try{
            await navigator.clipboard.writeText(String(prompt||''));
            btn.textContent = 'Copiado!';
            setTimeout(()=>btn.textContent='Copiar',1000);
          }catch{
            alert('N√£o foi poss√≠vel copiar.');
          }
        });
        frag.appendChild(div);
      });
      el.book.appendChild(frag);
    }

    function strategyHumanName(k){
      const map = { aprender:'APRENDER', treinar:'TREINAR', noticias:'NOT√çCIAS', casoreal:'CASO REAL' };
      return map[k] || k;
    }

    // ===== Gera√ß√£o =====
    function genAll(){
      const tema = (el.tema.value || '').trim();
      if(!tema){ alert('Digite o tema.'); el.tema.focus(); return; }
      current.tema = tema;
      el.result.style.display = 'none';
      el.thinking.style.display = 'flex';
      el.gerar.disabled = true;

      setTimeout(()=>{
        current.prompts.aprender  = Templates.aprender(tema);
        current.prompts.treinar   = Templates.treinar(tema);
        current.prompts.noticias  = Templates.noticias(tema);
        current.prompts.casoreal  = Templates.casoreal(tema);

        const ts = Date.now();
        pushEntry({ objetivo: strategyHumanName('aprender'), tema, prompt: current.prompts.aprender,  ts });
        pushEntry({ objetivo: strategyHumanName('treinar'),  tema, prompt: current.prompts.treinar,   ts });
        pushEntry({ objetivo: strategyHumanName('noticias'), tema, prompt: current.prompts.noticias,  ts });
        pushEntry({ objetivo: strategyHumanName('casoreal'), tema, prompt: current.prompts.casoreal,  ts });

        el.thinking.style.display = 'none';
        el.result.style.display = 'block';
        el.gerar.disabled = false;
      }, 600);
    }

    async function copy(text, btn){
      try{
        await navigator.clipboard.writeText(text);
        const hint = btn.querySelector('.hint'); const old = hint.textContent;
        hint.textContent = 'copiado!'; btn.disabled = true;
        setTimeout(()=>{ hint.textContent = old; btn.disabled = false; }, 1200);
      }catch{
        const ta = document.createElement('textarea'); ta.value = text; ta.style.position='fixed'; opacity='0';
        document.body.appendChild(ta); ta.select();
        try { document.execCommand('copy');
          const hint = btn.querySelector('.hint'); const old = hint.textContent;
          hint.textContent = 'copiado!'; setTimeout(()=>hint.textContent=old,1200);
        } catch { alert('N√£o foi poss√≠vel copiar.'); }
        finally { document.body.removeChild(ta); }
      }
    }

    function resetAll(){
      // limpa estado
      current = { tema:"", prompts:{ aprender:"", treinar:"", noticias:"", casoreal:"" } };
      el.tema.value = '';
      el.tema.focus();
      el.result.style.display = 'none';
      el.thinking.style.display = 'none';
      el.gerar.disabled = false;
    }

    // ===== Listeners =====
    document.getElementById('gerar').addEventListener('click', genAll);
    document.getElementById('tema').addEventListener('keydown', (e)=>{ if((e.ctrlKey||e.metaKey) && e.key.toLowerCase()==='enter') genAll(); });
    document.getElementById('copy-aprender').addEventListener('click', ()=>copy(current.prompts.aprender,  document.getElementById('copy-aprender')));
    document.getElementById('copy-treinar').addEventListener('click', ()=>copy(current.prompts.treinar,   document.getElementById('copy-treinar')));
    document.getElementById('copy-noticias').addEventListener('click',()=>copy(current.prompts.noticias,  document.getElementById('copy-noticias')));
    document.getElementById('copy-casoreal').addEventListener('click',()=>copy(current.prompts.casoreal,  document.getElementById('copy-casoreal')));
    document.getElementById('reset').addEventListener('click', resetAll); // ‚úÖ consertado

    // Inicializa
    selectTab('gerar');

    // PWA SW
    if ('serviceWorker' in navigator) {
      window.addEventListener('load', () => { navigator.serviceWorker.register('./sw.js').catch(()=>{}); });
    }
  </script>
</body>
</html>
