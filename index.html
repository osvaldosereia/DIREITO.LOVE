<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
  <title>direito.love — Criador de Prompts</title>
  <meta name="theme-color" content="#F5C400" />
  <meta name="description" content="direito.love — Criador de Prompts para estudo jurídico, OAB e concursos." />
  <link rel="icon" href="favicon.png" type="image/png" />
  <link rel="apple-touch-icon" href="favicon-180.png" />

  <style>
    :root{
      --bg:#FFFDF0; --surface:#ffffff; --text:#001840; --border:#e5e7eb;
      --primary:#102A71; --highlight:#F5C400; --highlight-light:#FFDC5F;
      --radius:12px; --shadow:0 4px 16px rgba(0,0,0,.05);
      --font:-apple-system,BlinkMacSystemFont,"Inter","Segoe UI",Roboto,system-ui,sans-serif;
      --safe-bottom: env(safe-area-inset-bottom, 0px);
      --snap-offset: 96px;

      /* Mesma escala de botões da /pesquisa */
      --btn-pad-y: 6px;
      --btn-pad-x: 10px;
      --btn-font: 12.5px;
      --btn-min-h: 34px;
      --btn-min-w: 96px;

      /* Cores extras */
      --success:#16a34a;
    }
    *{box-sizing:border-box}
    body{margin:0;background:var(--bg);color:var(--text);font:400 13.5px/1.45 var(--font);}

    /* Topbar (padrão da /pesquisa) */
    .topbar{position:sticky; top:0; z-index:100; background:var(--highlight); border-bottom:1px solid rgba(0,0,0,.08)}
    .topbar__inner{max-width:1160px; margin:0 auto; padding:8px 12px; display:flex; align-items:center; justify-content:space-between; gap:12px}
    .brand{display:flex; align-items:center; gap:10px; text-decoration:none; color:#111}
    .brand__logo{height:32px}
    .chip{
      padding:6px 10px; border-radius:8px; background:#fff; border:1px solid var(--border);
      font-size:12.5px; color:var(--primary); text-decoration:none; font-weight:600; transition:.15s
    }
    .chip:hover{background:var(--highlight-light)}

    /* Layout (sem “box” de fundo grandão) */
    .wrap{max-width:900px;margin:0 auto;padding:18px}
    h2{margin:0 0 12px;color:var(--primary);font-size:20px}

    /* Tema */
    label[for=tema]{display:block; margin:10px 0 6px; color:var(--primary); font-weight:700}
    #tema{
      width:100%; min-height:110px; resize:vertical;
      border:2px solid var(--primary); border-radius:10px; background:#fff; color:var(--text);
      padding:10px 12px; font-size:14px; outline:none;
    }
    #tema::placeholder{color:#9aa3af}

    .notice{
      display:none; margin:8px 0 10px;
      background:#fff7d6; border:1px solid #f3dd94; color:#5b4400;
      padding:8px 12px; border-radius:10px; font-weight:600;
    }
    .notice.show{ display:block; }

    /* Categorias (acordeões) — mesmos estilos da /pesquisa */
    #categorias{ margin-top: 10px; }
    .cat{
      background:#fff; border:1px solid var(--border); border-radius:12px; box-shadow: var(--shadow);
      margin:12px 0; overflow:hidden; scroll-margin-top: var(--snap-offset);
    }
    .cat > summary{
      list-style:none; cursor:pointer; padding:10px 14px; font-weight:800; color:var(--primary);
      display:flex; align-items:center; justify-content:space-between;
    }
    .cat > summary::-webkit-details-marker{ display:none; }
    .cat[open] > summary{ background:#fff7d6; }
    .cat-count{ font-weight:700; background:#0f172a0d; color:#0f172a; padding:2px 8px; border-radius:999px; font-size:12px; }

    /* Cards das opções: botão à direita */
    .option-card{
      background:#fff; border:1px solid var(--border); border-radius:10px; box-shadow:var(--shadow);
      padding:12px 14px; margin:10px 0;
      display:grid; grid-template-columns: 1fr auto; column-gap:10px; align-items:start;
    }
    .opt-title{grid-column:1; margin:0 0 6px 0; font-weight:700; color:#0f172a}
    .opt-desc{grid-column:1; margin:0; color:#1f2937}
    .opt-actions{grid-column:2; margin:0; justify-self:end; align-self:start; display:flex}
    .btn, .btn-ghost, .btn-alt{
      padding:var(--btn-pad-y) var(--btn-pad-x); border-radius:8px; font-size:var(--btn-font);
      min-height:var(--btn-min-h); min-width:var(--btn-min-w); cursor:pointer; transition:.15s;
    }
    .btn{appearance:none;border:1px solid var(--border);background:var(--highlight);color:#000;}
    .btn:hover{background:var(--highlight-light)}
    .btn-alt{appearance:none;border:1px solid #0f2a71;background:var(--primary);color:#fff;}
    .btn-alt:hover{background:#264399}
    .btn-alt.is-selected{ background: var(--success); color:#fff; border-color:#168a44; }
    .btn-alt.is-selected:hover{ filter:brightness(.95); }
    .btn-ghost{appearance:none;border:1px solid var(--border);background:#fff;color:#111;}
    .btn-ghost:hover{background:#f2f4f7}
    .btn.success{ background: var(--success); color:#fff; border:1px solid #168a44; }
    .btn.success:hover{ filter:brightness(.96); }

    /* Prévia (leve, sem card gigante) */
    .preview{ margin:16px 0 6px; }
    .preview h3{ margin:0 0 6px; color:var(--primary); font-size:16px }
    #saida{ width:100%; min-height:30vh; resize:vertical; padding:10px 12px; border-radius:10px; border:1px solid var(--border);
      background:#fff; color:#001840; font: 13.5px/1.45 ui-monospace, Menlo, Consolas, monospace; }

    /* Modal */
    .modal{ position:fixed; inset:0; display:none; align-items:center; justify-content:center; z-index:200; }
    .modal.show{ display:flex; }
    .modal__overlay{ position:absolute; inset:0; background:rgba(0,0,0,.35); }
    .modal__content{
      position:relative; background:#fff; border:1px solid var(--border); border-radius:12px; box-shadow:0 10px 30px rgba(0,0,0,.2);
      width:min(92vw,420px); padding:16px;
    }
    .modal__title{ margin:0 0 10px; color:#0f172a; font-size:16px; font-weight:800 }
    .modal__actions{ display:flex; gap:8px; justify-content:flex-end; flex-wrap:wrap }

    /* Mobile: diminuir só as descrições */
    @media (max-width: 600px){
      .opt-desc{ font-size:11.5px; line-height:1.35; }
      .option-card{ padding:10px 12px; }
    }
  </style>
</head>
<body>
  <!-- Topbar -->
  <header class="topbar" role="banner">
    <div class="topbar__inner">
      <a class="brand" href="index.html" aria-label="Início">
        <img class="brand__logo" src="icons/logo.png" alt="direito.love" />
      </a>
      <nav class="topbar__actions" aria-label="Ações">
        <a class="chip" href="index.html" aria-current="page">Prompt</a>
        <a class="chip" href="pesquisa.html">Pesquisar</a>
      </nav>
    </div>
  </header>

  <div class="wrap">
    <h2>Criador de Prompts para Estudantes de Direito</h2>

    <label for="tema">Digite o tema ou utilize a pesquisa para encontrar:</label>
    <textarea id="tema" placeholder="Ex.: Responsabilidade civil por erro médico no atendimento de emergência — art. 37, §6º, CF; CDC; jurisprudência do STJ..."></textarea>

    <!-- Aviso abaixo do tema -->
    <div id="importNotice" class="notice">Tema definido. Agora selecione as sessões do seu prompt.</div>

    <!-- Categorias -->
    <section id="categorias"></section>

    <!-- Prévia do Prompt -->
    <div class="preview" id="preview" style="display:none">
      <h3>Prévia do Prompt</h3>
      <textarea id="saida" readonly placeholder="(vazio)"></textarea>
    </div>
  </div>

  <!-- Modal de ação -->
  <div id="modal" class="modal" role="dialog" aria-modal="true" aria-labelledby="modalTitle" aria-hidden="true">
    <div class="modal__overlay"></div>
    <div class="modal__content">
      <h3 id="modalTitle" class="modal__title">O que deseja fazer?</h3>
      <div class="modal__actions">
        <button id="modalPrimary" class="btn primary">Gerar Prompt</button>
        <button id="modalSecondary" class="btn-ghost">Limpar</button>
      </div>
    </div>
  </div>

  <div id="toast" class="notice" style="position:fixed;left:50%;transform:translateX(-50%);bottom:18px;z-index:250;display:none;"></div>

<script>
(function(){
  const $=(s,r=document)=>r.querySelector(s);
  const $$=(s,r=document)=>[...r.querySelectorAll(s)];
  const showToast=(m,t=1600)=>{const el=$("#toast");el.textContent=m;el.style.display='block';setTimeout(()=>el.style.display='none',t);};

  /* ===== CATS & DIRECTIVES ===== */
  const CATS = [
    { id:'fund', label:'Fundamentos', items:[
      {id:'conceitos', label:'Conceitos e Definições', desc:'Definições objetivas, linguagem clara e diferenciações essenciais, com 1–2 exemplos curtos.'},
      {id:'base-legal', label:'Base Legal Essencial', desc:'Listar artigos pertinentes (nº + ementa curtíssima) e diplomas aplicáveis. Sem transcrição integral.'},
      {id:'doutrina', label:'Doutrina Relevante', desc:'Síntese de 2–3 autores e suas posições. Referência bibliográfica abreviada.'},
    ]},
    { id:'precedentes', label:'Precedentes e Enunciados', items:[
      {id:'juris-maj', label:'Jurisprudência Majoritária', desc:'Tese dominante (STJ/STF) + 2–4 precedentes (número + ideia central).'},
      {id:'sumulas', label:'Súmulas e Enunciados', desc:'Súmulas/Enunciados relevantes (nº + tese) — STF/STJ/TSE/FPPC/CJF.'},
      {id:'leading', label:'Casos Famosos / Leading Cases', desc:'3–5 casos paradigmáticos e a contribuição de cada um.'},
    ]},
    { id:'analise', label:'Análise e Estratégia', items:[
      {id:'raciocinio', label:'Raciocínio Jurídico (passo a passo)', desc:'Fluxo lógico (if/then) para resolver o caso, com premissas e conclusão.'},
      {id:'quadro-comp', label:'Quadro Comparativo', desc:'Tabela simples: critérios x alternativas, vantagens/risco/efeito.'},
      {id:'debates', label:'Debates, Críticas e Tendências', desc:'Controvérsias, críticas doutrinárias e tendências jurisprudenciais.'},
      {id:'atualiz', label:'Atualizações Recentes', desc:'Mudanças relevantes (últimos 12–24 meses) — leis e julgados.'},
      {id:'erros', label:'Erros Comuns', desc:'Armadilhas e confusões frequentes; como evitar.'},
    ]},
    { id:'pratica', label:'Prática Processual', items:[
      {id:'modelo', label:'Estrutura de Peça / Modelos', desc:'Esqueleto com seções obrigatórias e frases-modelo editáveis.'},
      {id:'check-peca', label:'Checklist de Peça', desc:'Checklist antes de protocolar: requisitos formais e materiais.'},
      {id:'casos', label:'Exemplos e Casos Práticos', desc:'Cenários hipotéticos curtos mostrando aplicação do direito.'},
    ]},
    { id:'estudo', label:'Estudo & Provas', items:[
      {id:'mapa', label:'Mapa Mental', desc:'Organograma textual (bullets hierárquicos) do tema.'},
      {id:'flash', label:'Flashcards', desc:'Cartões Q/A curtos para memorização.'},
      {id:'questoes', label:'Questões de Fixação', desc:'5–10 questões objetivas/discursivas; gabarito ao final.'},
      {id:'check-final', label:'Checklist Final de Revisão', desc:'Checklist rápido para revisão pré-prova.'},
      {id:'dicas', label:'Dicas de Prova (OAB/Concursos)', desc:'Estratégias, pegadinhas típicas e gestão de tempo.'},
    ]},
    { id:'refs', label:'Referências', items:[
      {id:'bibliog', label:'Referências Bibliográficas', desc:'Lista comentada de obras e artigos para aprofundar.'},
    ]},
  ];

  const DIRECTIVES = {
    'conceitos':'Faça definições diretas, compare com institutos próximos e ilustre com 1–2 exemplos breves.',
    'base-legal':'Liste artigos (nº + ementa curtíssima) e diplomas; evite transcrever integral. Cite seções específicas quando útil.',
    'doutrina':'Resuma 2–3 posições doutrinárias com referência abreviada (Autor, Obra, ano/página quando possível).',
    'juris-maj':'Traga a tese dominante (STJ/STF) e 2–4 julgados com número e ideia central, em bullets.',
    'sumulas':'Liste súmulas/enunciados relevantes com nº e tese, agrupando por tribunal/comissão.',
    'leading':'Selecione 3–5 leading cases; para cada um: contexto, holding e impacto.',
    'raciocinio':'Apresente o raciocínio em passos: fatos → norma → subsunção → conclusão, usando if/then.',
    'quadro-comp':'Monte uma tabela simples (texto) comparando critérios-chave entre alternativas.',
    'debates':'Aponte controvérsias, críticas e tendências; indique prós/cons de cada posição.',
    'atualiz':'Liste alterações legislativas e julgados relevantes nos últimos 12–24 meses.',
    'erros':'Liste armadilhas comuns e como evitá-las, de forma objetiva.',
    'modelo':'Entregue um esqueleto de peça com cabeçalho, fatos, fundamentos, pedidos e fechamento; inclua frases-modelo.',
    'check-peca':'Faça um checklist passo a passo para validação antes de protocolar.',
    'casos':'Crie 2–3 cenários práticos curtos mostrando a aplicação do tema.',
    'mapa':'Produza um mapa mental textual com bullets hierárquicos.',
    'flash':'Crie 8–12 flashcards (pergunta → resposta curta).',
    'questoes':'Redija 5–10 questões objetivas/discursivas e traga o gabarito ao final.',
    'check-final':'Checklist conciso de revisão para provas.',
    'dicas':'Dê estratégias de prova, pegadinhas típicas e gestão de tempo.',
    'bibliog':'Liste referências essenciais (livros/artigos) com breve comentário de utilidade.',
  };

  const BASE_PROMPT = `Você deve assumir a persona de um **professor especialista em todas as áreas do Direito brasileiro**, com didática impecável, convidado pelo **direito.love** para auxiliar um estudante de Direito.

📌 Tema escolhido: [INSERIR TEMA AQUI]
📌 Sequência de sessões: [INSERIR AQUI A SEQUÊNCIA DE SESSÕES DEFINIDA PELO USUÁRIO]

---
### Regras obrigatórias de escrita:
1) Siga exatamente a sequência das sessões pedidas; nenhuma pode ser omitida.
2) Formatação: títulos claros, bullets quando couber, parágrafos curtos. Quadros comparativos em tabela textual simples.
3) Em questões: numere (1, 2, 3…), alternativas (A–E) e inclua gabarito comentado no final.
4) Evite transcrições longas; foque em síntese com alta aplicabilidade prática.
5) Linguagem clara e técnica quando necessário.

No final, assine com: 💚 direito.love`;

  /* ===== Render categorias ===== */
  const categoriasEl = $("#categorias");
  const selected = new Set();

  function renderCategorias(){
    categoriasEl.innerHTML='';
    for(const cat of CATS){
      const det=document.createElement('details'); det.className='cat'; det.dataset.cat=cat.id;
      const sum=document.createElement('summary');
      const title=document.createElement('span'); title.textContent=cat.label;
      const count=document.createElement('span'); count.className='cat-count'; count.textContent=cat.items.length;
      sum.appendChild(title); sum.appendChild(count);
      det.appendChild(sum);

      const body=document.createElement('div'); body.className='cat-body';

      for(const it of cat.items){
        const card=document.createElement('div'); card.className='option-card'; card.dataset.id=it.id;

        const h=document.createElement('p'); h.className='opt-title'; h.textContent=it.label;
        const d=document.createElement('p'); d.className='opt-desc'; d.textContent=it.desc;
        const actions=document.createElement('div'); actions.className='opt-actions';

        const btnSel=document.createElement('button'); btnSel.className='btn-alt btn-select'; btnSel.textContent='Selecionar';
        const sync=()=>{ const on=selected.has(it.id); btnSel.textContent=on?'Selecionado':'Selecionar'; btnSel.classList.toggle('is-selected',on); };
        btnSel.addEventListener('click',()=>{ if(selected.has(it.id)) selected.delete(it.id); else selected.add(it.id); sync(); });
        sync();

        actions.appendChild(btnSel);
        card.appendChild(h); card.appendChild(d); card.appendChild(actions);
        body.appendChild(card);
      }

      det.appendChild(body);
      categoriasEl.appendChild(det);
    }
  }

  /* ===== Build Prompt ===== */
  const temaEl=$("#tema"), saida=$("#saida"), preview=$("#preview");
  function buildPrompt(){
    const tema=(temaEl.value||'').trim();
    if(!tema){ showToast('Digite um tema.'); return ''; }
    if(!selected.size){ showToast('Selecione ao menos 1 sessão.'); return ''; }

    const order=[]; for(const cat of CATS) for(const it of cat.items) if(selected.has(it.id)) order.push(it);
    const seq=order.map(it=>it.label).join(' → ');
    const header=BASE_PROMPT.replace('[INSERIR TEMA AQUI]', tema).replace('[INSERIR AQUI A SEQUÊNCIA DE SESSÕES DEFINIDA PELO USUÁRIO]', seq);

    const lines=[header,'','---','### Seções com diretrizes detalhadas'];
    for(const it of order){
      lines.push(`\n## ${it.label}`);
      if(it.desc) lines.push(`Descrição: ${it.desc}`);
      if(DIRECTIVES[it.id]) lines.push(`Instruções para a IA: ${DIRECTIVES[it.id]}`);
    }
    return lines.join('\n');
  }

  /* ===== Modal ===== */
  const modal=$("#modal"), modalPrimary=$("#modalPrimary"), modalSecondary=$("#modalSecondary"), modalTitle=$("#modalTitle");
  let hasPrompt=false; // muda após gerar

  function openModal(mode){ // 'pre' ou 'post'
    if(mode==='pre'){
      modalTitle.textContent='O que deseja fazer?';
      modalPrimary.textContent='Gerar Prompt';
      modalPrimary.className='btn primary';
      modalSecondary.textContent='Limpar';
      modalSecondary.className='btn-ghost';
    }else{
      modalTitle.textContent='Prompt pronto!';
      modalPrimary.textContent='Copiar Prompt';
      modalPrimary.className='btn success';
      modalSecondary.textContent='Novo';
      modalSecondary.className='btn-ghost';
    }
    modal.classList.add('show'); modal.setAttribute('aria-hidden','false');
  }
  function closeModal(){ modal.classList.remove('show'); modal.setAttribute('aria-hidden','true'); }

  modal.addEventListener('click', (e)=>{ if(e.target.classList.contains('modal__overlay')) closeModal(); });

  modalPrimary.addEventListener('click', async()=>{
    if(!hasPrompt){
      const txt=buildPrompt(); if(!txt) return;
      saida.value=txt; preview.style.display='block'; hasPrompt=true; openModal('post');
      showToast('Prompt criado!');
    }else{
      // Copiar
      try{ await navigator.clipboard.writeText(saida.value||''); showToast('Prompt copiado!'); }catch{ showToast('Erro ao copiar.'); }
      closeModal();
    }
  });

  function resetAll(){
    temaEl.value=''; saida.value=''; preview.style.display='none'; hasPrompt=false;
    selected.clear(); $$('.btn-select.is-selected').forEach(b=>b.classList.remove('is-selected'));
    $$('.btn-select').forEach(b=>b.textContent='Selecionar');
    $('#importNotice')?.classList.remove('show');
  }

  modalSecondary.addEventListener('click', ()=>{
    if(!hasPrompt){ // Limpar
      resetAll(); closeModal();
    }else{ // Novo
      resetAll(); closeModal(); temaEl.focus(); window.scrollTo({top:0,behavior:'smooth'});
    }
  });

  // Abre o modal assim que o tema for definido
  let openedOnce=false;
  temaEl.addEventListener('input', ()=>{
    const has=(temaEl.value||'').trim().length>0;
    $('#importNotice').classList.toggle('show', has);
    if(has && !openedOnce){ openModal('pre'); openedOnce=true; }
  });

  // Importar direto da pesquisa (#pesquisa)
  (function importFromPesquisa(){
    const KEY='dl_pesquisa_selecionados';
    try{
      const arr=JSON.parse(localStorage.getItem(KEY)||'[]');
      if((location.hash==='#pesquisa'||arr.length) && arr.length){
        const full=arr.map(i=> i.texto ? String(i.texto).trim() : [i.title||'', i.url||''].filter(Boolean).join(' — '))
                      .filter(Boolean).join('\n\n');
        if(full.trim()){
          temaEl.value=full.replace(/\s+\n\s+/g,'\n').trim();
          $('#importNotice')?.classList.add('show');
          openedOnce=true; // evita abrir 2x
          openModal('pre'); // já chama o modal quando vem da pesquisa
        }
        localStorage.removeItem(KEY);
      }
    }catch(e){}
  })();

  /* Boot */
  renderCategorias();
})();
</script>
</body>
</html>
