<!doctype html>
<html lang="pt-BR">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
  <meta name="theme-color" content="#0c4160" />
  <title>direito.love</title>

  <!-- PWA -->
  <link rel="manifest" href="./manifest.json">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="default">
  <link rel="apple-touch-icon" href="./icons/icon-192.png" />

  <style>
    :root{
      --ink:#0b2f3b; --bg:#ffffff; --panel:#63cfc1; --panel-2:#e9f2f5;
      --btn:#0b3b4a; --btn-copy:#6b7785; --btn-reset:#4b5563;
      --border:#d8e2e7; --topbar:#0c4160; --topbar-h:52px; --logo-h:30px;
    }
    *{box-sizing:border-box}
    body{margin:0;font-family:Inter, system-ui, -apple-system, Segoe UI, Roboto, Arial;background:var(--bg);color:var(--ink);padding-top:var(--topbar-h)}

    /* Topbar fixa */
    .topbar{position:fixed;top:0;left:0;right:0;height:var(--topbar-h);background:var(--topbar);z-index:1000;border-bottom:1px solid var(--border)}
    .brand-wrap{display:flex;align-items:center;gap:8px;min-width:0}
    .brand-logo{display:block;height:var(--logo-h);width:auto;max-width:min(220px,60vw);object-fit:contain;object-position:left center}
    .insta-link{display:inline-flex;align-items:center;justify-content:center;width:24px;height:24px;border-radius:6px;text-decoration:none;transition:transform .12s ease}
    .insta-link:hover{transform:translateY(-1px)}
    .insta-link svg{display:block;width:100%;height:100%}

    /* NOVO: container interno para limitar a largura no desktop */
    .topbar-inner{
      display:flex;
      align-items:center;
      justify-content:space-between;
      width:100%;
      padding:0 14px;      /* respiro lateral no mobile */
      margin:0 auto;
    }
    @media (min-width:861px){
      .topbar-inner{
        max-width:960px;   /* mesmo limite dos pain√©is */
        padding:0 8px;     /* respiro leve no desktop */
      }
    }

    /* ===== POPUP PWA (flutuante) ===== */
    #pwa-popup{display:none;position:fixed;left:50%;top:12px;transform:translateX(-50%);
      max-width:560px;width:calc(100% - 24px);background:#0b2f3b;color:#fff;border-radius:14px;
      box-shadow:0 10px 28px rgba(0,0,0,.25);padding:12px;z-index:10010}
    #pwa-popup .row{display:flex;align-items:center;gap:12px}
    #pwa-popup .txt{flex:1;font-size:14px;font-weight:700}
    #pwa-popup .actions{display:flex;gap:8px}
    .pwa-btn{display:inline-flex;align-items:center;justify-content:center;border:0;outline:0;cursor:pointer;background:#63d1c3;color:#06343e;font-weight:800;padding:8px 14px;border-radius:999px}
    .pwa-btn.secondary{background:#6b7785;color:#fff}
    .pwa-close-x{appearance:none;border:0;background:transparent;color:#fff;font-size:18px;line-height:1;cursor:pointer;padding:2px 6px}

    /* Conte√∫do base */
    .hero{display:grid;gap:8px;max-width:960px;margin:0 auto;padding:28px 16px 16px;align-items:start}
    .quote{font-weight:800;line-height:1.05;color:var(--ink);font-size:clamp(24px,6vw,56px)}
    .author{font-style:italic;font-size:clamp(13px,2.2vw,20px);opacity:.85}

    .panel{background:var(--panel);border-radius:24px;padding:20px;max-width:960px;margin:0 auto}
    @media (min-width:861px){.panel{padding:28px;box-shadow:0 10px 28px rgba(0,0,0,.06)}}

    .field-wrap{margin:14px 0 16px}
    .label{font-weight:900;font-size:clamp(15px,2.3vw,22px);color:#08333e;margin:0 0 10px}
    .field{width:100%;background:var(--panel-2);border:1px solid var(--border);border-radius:16px;padding:14px;color:#11323c}
    textarea.field{min-height:110px;resize:vertical}

    .actions-out{display:flex;flex-direction:column;gap:12px}
    .actions-buttons{display:flex;gap:10px;flex-wrap:wrap}
    .btn{border:none;border-radius:999px;padding:9px 16px;font-weight:800;letter-spacing:.3px;color:#fff;cursor:pointer}
    .btn-primary{background:var(--btn)}
    .btn-copy{background:var(--btn-copy);font-size:14px;padding:7px 12px}
    .btn-reset{background:var(--btn-reset)}
    .output{background:var(--panel-2);border:1px solid var(--border);border-radius:16px;min-height:150px;padding:14px;color:#16333b;width:100%;resize:vertical}

    /* Abas */
    .tabs{max-width:960px;margin:12px auto;padding:0 16px;display:none;gap:8px}
    .tab-btn{border:1px solid var(--border);background:#fff;color:#000;padding:7px 12px;border-radius:999px;font-weight:700;cursor:pointer;font-size:14px}
    .tab-btn[aria-selected="true"]{background:var(--ink);color:#fff;border-color:transparent}
    .tabbar{position:fixed;bottom:0;left:0;right:0;height:44px;background:#ffffff;border-top:1px solid var(--border);display:flex;justify-content:space-around;align-items:center;z-index:1000}
    .tabbar button{all:unset;cursor:pointer;display:flex;flex-direction:column;align-items:center;gap:2px;padding:4px 8px;border-radius:8px}
    .tabbar button[aria-selected="true"]{background:#e7fbf8}
    .tabbar .lbl{font-size:15px;font-weight:700;color:#0b2f3b}
    .tab-content{display:none;padding-bottom:56px}
    .tab-content.is-active{display:block}
    @media (min-width:861px){.tabbar{display:none}.tabs{display:flex}.tab-content{padding-bottom:16px}}

    /* ===== ARQUIVO (book) ‚Äî ESTILOS ===== */
    .book-list{
      display:grid;
      gap:12px;
      max-height:60vh;     /* rolagem s√≥ dentro da lista */
      overflow:auto;
      padding-right:6px;
      scroll-behavior:smooth;
    }
    .book-item{
      display:flex;
      align-items:flex-start;
      justify-content:space-between;
      gap:12px;
      background:var(--panel-2);
      border:1px solid var(--border);
      border-radius:16px;
      padding:12px 14px;
    }
    .book-meta{display:grid;gap:4px;min-width:0}
    .book-obj{font-weight:900;color:#08333e}
    .book-tema{color:#16333b;word-break:break-word}
    .chipbtn{
      border:1px solid var(--border);
      background:#ffffff;
      color:#0b2f3b;
      font-weight:800;
      padding:7px 12px;
      border-radius:999px;
      cursor:pointer;
      white-space:nowrap;
    }
    .chipbtn:active{transform:translateY(1px)}
    @media (max-width:480px){
      .book-item{flex-direction:column;align-items:stretch}
      .chipbtn{align-self:flex-start}
    }
  </style>
</head>
<body>
  <!-- Topbar -->
  <nav class="topbar" aria-label="Barra superior">
    <div class="topbar-inner">
      <a class="brand-wrap" href="./" aria-label="direito.love ‚Äî in√≠cio">
        <img class="brand-logo" src="./icons/logo-menu.png"
             onerror="this.onerror=null; this.src='./icons/icon-192.png';"
             alt="direito.love">
      </a>
      <div class="right">
        <a class="insta-link" href="https://www.instagram.com/osvaldosereiajr/" target="_blank" rel="noopener" aria-label="Abrir Instagram @osvaldosereiajr" title="@osvaldosereiajr">
          <svg viewBox="0 0 24 24" aria-hidden="true" focusable="false">
            <defs><linearGradient id="igGrad" x1="0" y1="0" x2="1" y2="1"><stop offset="0%" stop-color="#f58529"/><stop offset="30%" stop-color="#feda77"/><stop offset="60%" stop-color="#dd2a7b"/><stop offset="80%" stop-color="#8134af"/><stop offset="100%" stop-color="#515bd4"/></linearGradient></defs>
            <rect x="0" y="0" width="24" height="24" rx="6" fill="url(#igGrad)"/>
            <rect x="3" y="3" width="18" height="18" rx="5" fill="none" stroke="#ffffff" stroke-width="2"/>
            <circle cx="12" cy="12" r="4.5" fill="none" stroke="#ffffff" stroke-width="2"/>
            <circle cx="17.2" cy="6.8" r="1.3" fill="#ffffff"/>
          </svg>
        </a>
      </div>
    </div>
  </nav>

  <!-- POPUP PWA -->
  <div id="pwa-popup" role="dialog" aria-live="polite" aria-label="Instalar aplicativo">
    <div class="row">
      <div id="pwa-msg" class="txt">Instale o app para acesso r√°pido.</div>
      <div class="actions">
        <button id="pwa-install" class="pwa-btn" type="button">Instalar</button>
        <button id="pwa-close" class="pwa-btn secondary" type="button">Fechar</button>
      </div>
      <button id="pwa-x" class="pwa-close-x" aria-label="Fechar">√ó</button>
    </div>
  </div>

  <header class="hero">
    <div id="quote" class="quote">‚Äî</div>
    <div id="author" class="author"></div>
  </header>

  <nav class="tabs" role="tablist">
    <button class="tab-btn" aria-selected="true" aria-controls="tab-gerador" id="tabbtn-gerador">Gerador</button>
    <button class="tab-btn" aria-selected="false" aria-controls="tab-book" id="tabbtn-book">Arquivo</button>
    <button class="tab-btn" aria-selected="false" aria-controls="tab-dicas" id="tabbtn-dicas">Dicas</button>
  </nav>

  <!-- Gerador -->
  <section id="tab-gerador" class="tab-content is-active">
    <main class="panel">
      <div class="field-wrap">
        <h3 class="label">Qual seu objetivo?</h3>
        <select id="strategy" class="field">
          <option value="explicacao">Explica√ß√£o B√°sica</option>
          <option value="resumo">Resumo Objetivo</option>
          <option value="artigo">An√°lise Detalhada</option>
          <option value="aplicacao">Aplica√ß√£o Pr√°tica</option>
          <option value="simulado">Exerc√≠cios/Testes</option>
          <option value="faq">Perguntas Frequentes</option>
          <option value="debate">Debate/Reflex√£o</option>
          <option value="atualizacao">Contexto Atualizado</option>
          <option value="plano">Plano de Estudo</option>
          <option value="sustentacao">Apresenta√ß√£o em Sala</option>
          <option value="jurisprudencia">Jurisprud√™ncia</option>
        </select>
      </div>
      <div class="field-wrap">
        <h3 class="label">Vamos falar sobre o qu√™?</h3>
        <textarea id="theme" class="field" placeholder="Digite o tema"></textarea>
      </div>
      <div class="actions-out">
        <div class="actions-buttons">
          <button id="generate" class="btn btn-primary">Gerar</button>
          <button id="copy" class="btn btn-copy">Copiar</button>
          <button id="reset" class="btn btn-reset">Reiniciar</button>
        </div>
        <textarea id="result" class="output" placeholder="Prompt gerado aqui..." readonly></textarea>
      </div>
    </main>
  </section>

  <!-- Arquivo -->
  <section id="tab-book" class="tab-content">
    <main class="panel">
      <h2 class="label">Arquivo ‚Äì Suas √∫ltimas 500 gera√ß√µes</h2>
      <p class="field" style="min-height:0;margin-top:0">Carrega automaticamente de 10 em 10 enquanto voc√™ rola.</p>
      <div id="book-list" class="book-list"></div>
    </main>
  </section>

  <!-- Dicas -->
  <section id="tab-dicas" class="tab-content">
    <main class="panel">
      <h2 class="label">üìò Estruturas de Resposta</h2>
      <div class="field" style="white-space:pre-wrap">
1. <b>Explica√ß√£o B√°sica</b>

<b>Objetivo:</b> oferecer ao estudante uma introdu√ß√£o simples e acess√≠vel.
- Defini√ß√£o curta (1‚Äì2 linhas).
- 2 a 3 analogias do cotidiano para facilitar a compreens√£o.
- 3 pontos-chave que resumem a ess√™ncia do tema.
- 2 erros comuns que os iniciantes costumam cometer.
- Mini-exemplo pr√°tico para fixar o conte√∫do.

2. <b>Resumo Objetivo</b>

<b>Objetivo:</b> condensar o tema em uma s√≠ntese r√°pida, mas completa.
- Conceito em at√© 2 linhas.
- Base legal principal.
- Estrutura essencial (elementos que comp√µem o instituto).
- 3 diferen√ßas em rela√ß√£o a temas que normalmente geram confus√£o.
- Tend√™ncias atuais na doutrina e jurisprud√™ncia.
- 3 pegadinhas recorrentes em provas.
- 2 mini-casos ilustrativos para aplica√ß√£o imediata.

3. <b>An√°lise Detalhada (Artigo Acad√™mico)</b>

<b>Objetivo:</b> aprofundar o estudo em formato cient√≠fico.
- Introdu√ß√£o: problema, relev√¢ncia pr√°tica e hip√≥tese de trabalho.
- Desenvolvimento: conceitos centrais, correntes doutrin√°rias, an√°lise cr√≠tica e jurisprud√™ncia selecionada.
- Conclus√£o: s√≠ntese do debate, posicionamento fundamentado e proposta de solu√ß√£o ou tend√™ncia.

4. <b>Aplica√ß√£o Pr√°tica</b>

<b>Objetivo:</b> mostrar como o tema se traduz no dia a dia do Direito.
- Caso fict√≠cio realista.
- Enquadramento jur√≠dico passo a passo.
- Solu√ß√£o prov√°vel (e alternativas).
- Mini-modelo de pe√ßa processual (endere√ßamento, fundamentos, pedidos).
- Checklist final com os pontos que n√£o podem ser esquecidos.

5. <b>Exerc√≠cios/Testes</b>

<b>Objetivo:</b> avaliar o aprendizado com diferentes n√≠veis de dificuldade.
- 5 quest√µes no total: 2 f√°ceis, 2 intermedi√°rias e 1 avan√ßada.
- Gabarito comentado, explicando o porqu√™ de cada resposta.

6. <b>FAQ (Perguntas Frequentes)</b>

<b>Objetivo:</b> resolver as principais d√∫vidas em pouco tempo.
- 15 perguntas essenciais respondidas em at√© 3 linhas cada.
- 2 confus√µes comuns corrigidas para evitar erros.

7. <b>Debate/Reflex√£o</b>

<b>Objetivo:</b> estimular pensamento cr√≠tico e discuss√£o acad√™mica.
- Problema central bem delimitado.
- 3 argumentos a favor e 3 contra.
- 1 dilema pr√°tico para reflex√£o.
- Perguntas-guia para incentivar debate em sala ou estudo em grupo.

8. <b>Contexto Atualizado</b>

<b>Objetivo:</b> conectar o tema √† realidade atual.
- Panorama legislativo recente.
- Jurisprud√™ncia mais atualizada.
- Impactos pr√°ticos no cotidiano do Direito.
- Pontos ainda controversos ou em evolu√ß√£o.

9. <b>Plano de Estudo</b>

<b>Objetivo:</b> ajudar o estudante a organizar a prepara√ß√£o.
- Cronograma de 4 semanas.
- Rotina de revis√£o espa√ßada para fixa√ß√£o.
- Exerc√≠cios recomendados.
- Erros mais comuns a monitorar.

10. <b>Apresenta√ß√£o em Sala</b>

<b>Objetivo:</b> estruturar um discurso oral de impacto (4 min).
- Abertura envolvente.
- Contextualiza√ß√£o do tema.
- Base legal, doutrina e jurisprud√™ncia segura.
- Caso ilustrativo que prenda a aten√ß√£o.
- Argumenta√ß√£o bem constru√≠da.
- Fechamento marcante com s√≠ntese.

11. <b>Jurisprud√™ncia (Radar)</b>

<b>Objetivo:</b> oferecer panorama pr√°tico de decis√µes.
- 15 itens verificados e confi√°veis.
- Cada item deve conter: tribunal, n√∫mero, ano, tese resumida (2‚Äì3 linhas) e impacto pr√°tico.
      </div>
    </main>
  </section>

  <div class="footer"></div>

  <nav class="tabbar" role="tablist">
    <button aria-selected="true" aria-controls="tab-gerador" id="m-tabbtn-gerador"><span class="lbl">Gerar</span></button>
    <button aria-selected="false" aria-controls="tab-book" id="m-tabbtn-book"><span class="lbl">Arquivo</span></button>
    <button aria-selected="false" aria-controls="tab-dicas" id="m-tabbtn-dicas"><span class="lbl">Dicas</span></button>
  </nav>

  <script>
    // ===== Frases (frases.txt na raiz) =====
    async function loadRandomQuoteFromFile(){
      const fallback = ['N√£o h√° liberdade sem lei. ‚Äî Montesquieu','A justi√ßa sem for√ßa √© impotente; a for√ßa sem justi√ßa √© tirana. ‚Äî Pascal'];
      try{
        const res = await fetch('./frases.txt', {cache:'no-cache'});
        if(!res.ok) throw new Error('HTTP '+res.status);
        const text = await res.text();
        const lines = text.split(/\r?\n/).map(s=>s.trim()).filter(s=>s && !s.startsWith('#'));
        const arr = lines.length ? lines : fallback;
        const pick = arr[Math.floor(Math.random()*arr.length)];
        const parts = pick.split('‚Äî');
        document.getElementById('quote').textContent = (parts[0]||pick).trim();
        document.getElementById('author').textContent = parts[1] ? '‚Äî '+parts[1].trim() : '';
      }catch{
        const pick = fallback[Math.floor(Math.random()*fallback.length)];
        const parts = pick.split('‚Äî');
        document.getElementById('quote').textContent = (parts[0]||pick).trim();
        document.getElementById('author').textContent = parts[1] ? '‚Äî '+parts[1].trim() : '';
      }
    }
    loadRandomQuoteFromFile();

    // ===== Tabs =====
    const tabIds=['gerador','book','dicas'];
    function activateTab(id){
      for(const t of tabIds){
        document.getElementById('tab-'+t).classList.toggle('is-active',t===id);
        document.getElementById('tabbtn-'+t)?.setAttribute('aria-selected',String(t===id));
        document.getElementById('m-tabbtn-'+t)?.setAttribute('aria-selected',String(t===id));
      }
    }
    for(const t of tabIds){
      document.getElementById('tabbtn-'+t)?.addEventListener('click',()=>activateTab(t));
      document.getElementById('m-tabbtn-'+t)?.addEventListener('click',()=>activateTab(t));
    }

    // ===== PWA: Service Worker =====
    if ('serviceWorker' in navigator) {
      window.addEventListener('load', () => {
        navigator.serviceWorker.register('./sw.js').catch(()=>{});
      });
    }

    // ===== PWA: POPUP =====
    (function () {
      const popup = document.getElementById('pwa-popup');
      const btnInstall = document.getElementById('pwa-install');
      const btnClose = document.getElementById('pwa-close');
      const btnX = document.getElementById('pwa-x');
      const msg = document.getElementById('pwa-msg');

      const REAPPEAR_DAYS = 7, MS = 86400000;
      const KEY_DISMISSED_AT = 'pwa_popup_dismissed_at';
      const KEY_INSTALLED = 'pwa_popup_installed';

      const standalone = matchMedia('(display-mode: standalone)').matches || navigator.standalone === true;
      if (standalone) { localStorage.setItem(KEY_INSTALLED,'1'); return; }
      if (localStorage.getItem(KEY_INSTALLED)==='1') return;

      const lastDismiss = Number(localStorage.getItem(KEY_DISMISSED_AT) || 0);
      const blocked = lastDismiss && (Date.now() - lastDismiss) < (REAPPEAR_DAYS * MS);
      if (blocked) return;

      let deferredPrompt = null;
      let shown = false;

      window.addEventListener('beforeinstallprompt', (e) => {
        e.preventDefault();
        deferredPrompt = e;
        if (!shown){ popup.style.display='block'; shown=true; }
      });

      const ua = navigator.userAgent;
      const isIOS = /iphone|ipad|ipod/i.test(ua);
      const isSafari = /^((?!chrome|android).)*safari/i.test(ua);
      if (isIOS && isSafari) {
        setTimeout(()=>{ msg.innerHTML='No iPhone: toque em <b>Compartilhar</b> ‚Üí <b>Adicionar √† Tela de In√≠cio</b>.'; popup.style.display='block'; shown=true; }, 400);
      }

      setTimeout(()=>{ 
        if (!shown){ msg.innerHTML='No Android: tr√™s pontinhos do Chrome ‚Üí <b>Adicionar √† tela inicial</b>.'; popup.style.display='block'; shown=true; }
      }, 6000);

      function closePopup(){
        localStorage.setItem(KEY_DISMISSED_AT, String(Date.now()));
        popup.style.display='none';
      }
      btnClose.addEventListener('click', (e)=>{ e.preventDefault(); e.stopPropagation(); closePopup(); });
      btnX.addEventListener('click', (e)=>{ e.preventDefault(); e.stopPropagation(); closePopup(); });

      btnInstall.addEventListener('click', async (e) => {
        e.preventDefault(); e.stopPropagation();
        if (deferredPrompt) {
          deferredPrompt.prompt();
          await deferredPrompt.userChoice.catch(()=>{});
          deferredPrompt = null;
          closePopup();
          return;
        }
        alert('No Android/Chrome: toque nos tr√™s pontinhos ‚Üí "Adicionar √† tela inicial".');
      });

      window.addEventListener('appinstalled', () => {
        localStorage.setItem(KEY_INSTALLED,'1');
        popup.style.display='none';
      });
    })();

    // ====== GERADOR: TEMPLATES ======
    const TEMPLATES = {
      explicacao: (tema) => `Voc√™ √© um **tutor de Direito** no Brasil, especialista em did√°tica jur√≠dica.
Persona: professor paciente e criativo, que explica para iniciantes.
Linguagem: simples, clara, sem juridiqu√™s; use analogias.

Tarefa: Explique o tema **${tema}**.
Estrutura:
1) Defini√ß√£o essencial (at√© 3 linhas).
2) 2‚Äì3 analogias do cotidiano.
3) 3 pontos-chave (o que √©, para que serve, onde se aplica).
4) 2 erros comuns dos alunos + forma correta.
5) Mini-exemplo pr√°tico.

Recursos: headings (H2‚ÄìH3), listas, par√°grafos curtos.
Regras: sem links; enunciados, s√∫mulas e jurisprud√™ncia s√≥ se 100% segura.

Fecho: s√≠ntese (2 frases) + fontes (at√© 5).`,

      resumo: (tema) => `Voc√™ √© um **professor universit√°rio de Direito** no Brasil, especialista em provas da OAB e concursos.
Persona: objetivo e estrat√©gico, como quem monta checklists.
Linguagem: direta, sem floreios.

Tarefa: Resuma **${tema}** em formato RAIO-X.
Inclua:
1) Conceito-chave (at√© 2 linhas);
2) Base legal essencial (artigos);
3) Estrutura/elementos;
4) Diferen√ßas f√°ceis de confundir (3 pares);
5) Tend√™ncias jurisprudenciais;
6) 3 pegadinhas de prova;
7) 2 mini-cases resolvidos.

Recursos: t√≥picos numerados, negrito nos termos centrais.
Regras: sem links; enunciados, s√∫mulas e jurisprud√™ncia s√≥ se 100% segura.

Fecho: resumo de bolso (2 frases) + fontes (at√© 5).`,

      artigo: (tema) => `Voc√™ √© um **jurista pesquisador**, especialista em produ√ß√£o acad√™mica.
Persona: acad√™mico cr√≠tico, mas acess√≠vel.
Linguagem: t√©cnica, formal, sem excesso; par√°grafos curtos.

Tarefa: Produza artigo acad√™mico sobre **${tema}**.
Estrutura:
# Introdu√ß√£o: problema, relev√¢ncia pr√°tica e hip√≥tese.
# Desenvolvimento: conceitos centrais, evolu√ß√£o hist√≥rica, correntes doutrin√°rias (pr√≥s/contr√°s), an√°lise cr√≠tica, tend√™ncias jurisprudenciais, (opcional: direito comparado).
# Conclus√£o: s√≠ntese cr√≠tica + proposta pr√°tica.

Recursos: headings H1‚ÄìH4, listas quando cab√≠veis, destaques em **negrito**.
Regras: sem links; enunciados, s√∫mulas e jurisprud√™ncia s√≥ se 100% segura.

Fecho: resumo final (2 frases) + refer√™ncias (at√© 5).`,

      aplicacao: (tema) => `Voc√™ √© um **advogado experiente e professor de pr√°tica jur√≠dica**.
Persona: pr√°tico, direto, como quem treina estagi√°rios.
Linguagem: clara, com exemplos.

Tarefa: Mostre como aplicar **${tema}** na pr√°tica.
Estrutura:
1) Caso fict√≠cio realista.
2) Enquadramento jur√≠dico (fundamentos e racioc√≠nio).
3) Solu√ß√£o prov√°vel (e alternativas).
4) Mini-modelo de pe√ßa (endere√ßamento, fatos, fundamentos, pedidos).
5) Checklist (3‚Äì5 pontos).

Recursos: listas, blocos de texto para pe√ßas.
Regras: sem links; enunciados, s√∫mulas e jurisprud√™ncia s√≥ se 100% segura.

Fecho: resumo executivo (2 frases) + fontes (at√© 5).`,

      simulado: (tema) => `Voc√™ √© um **examinador da OAB** montando quest√µes sobre ${tema}.
Persona: avaliador exigente, mas did√°tico no coment√°rio.
Linguagem: objetiva, estilo prova.

Tarefa: Crie 5 quest√µes sobre **${tema}**.
Estrutura:
- 2 f√°ceis, 2 m√©dias, 1 dif√≠cil.
- Estilo m√∫ltipla escolha ou discursiva curta.
- Gabarito comentado logo ap√≥s cada quest√£o.

Recursos: blocos por quest√£o; resposta correta em **negrito**.
Regras: sem links; jurisprud√™ncia s√≥ se 100% segura.

Fecho: 3 dicas pr√°ticas de estudo + fontes (at√© 5).`,

      faq: (tema) => `Voc√™ √© um **monitor de Direito** explicando conceitos b√°sicos.
Persona: colega did√°tico, r√°pido e claro.
Linguagem: simples, sem juridiqu√™s.

Tarefa: Responda d√∫vidas r√°pidas sobre **${tema}**.
Estrutura:
- 15 perguntas essenciais.
- Respostas em at√© 3 linhas.
- 2 confus√µes comuns + a forma correta.

Recursos: pergunta em **negrito**, resposta em texto normal.
Regras: sem links; enunciados, s√∫mulas e jurisprud√™ncia s√≥ se 100% segura.

Fecho: resumo de bolso (2 frases) + fontes (at√© 5).`,

      debate: (tema) => `Voc√™ √© um **professor de Filosofia do Direito** mediando debate sobre ${tema}.
Persona: provocador cr√≠tico, mas neutro.
Linguagem: reflexiva e clara.

Tarefa: Promova um debate sobre **${tema}**.
Estrutura:
1) Problema central (at√© 4 linhas).
2) 3 argumentos pr√≥.
3) 3 argumentos contra.
4) 1 dilema √©tico ou pr√°tico.
5) Perguntas-guia para discuss√£o.

Recursos: listas; destaques em **negrito**.
Regras: sem links; enunciados, s√∫mulas e jurisprud√™ncia s√≥ se 100% segura.

Fecho: s√≠ntese imparcial (2 frases) + fontes (at√© 5).`,

      atualizacao: (tema) => {
        const d=new Date();
        const data=`${d.getFullYear()}-${String(d.getMonth()+1).padStart(2,'0')}-${String(d.getDate()).padStart(2,'0')}`;
        return `Voc√™ √© um **jurista analista de legisla√ß√£o e jurisprud√™ncia**.
Persona: atualizado, conecta norma e impacto pr√°tico.
Linguagem: clara, objetiva.

Tarefa: Traga panorama atualizado sobre **${tema}** (at√© ${data}).
Estrutura:
1) Altera√ß√µes legislativas recentes.
2) Tend√™ncias jurisprudenciais atuais.
3) Impactos pr√°ticos (provas e advocacia).
4) Pontos controversos e cuidados.

Recursos: subt√≠tulos H3; destaque artigos em **negrito**.
Regras: sem links; enunciados, s√∫mulas e jurisprud√™ncia s√≥ se 100% segura.

Fecho: resumo (2 frases) + fontes (at√© 5).`;
      },

      plano: (tema) => `Voc√™ √© um **coach de estudos jur√≠dicos** especialista em memoriza√ß√£o.
Persona: motivador, organizado.
Linguagem: objetiva e encorajadora.

Tarefa: Crie plano de estudo sobre **${tema}** para 4 semanas.
Estrutura:
1) Objetivo do ciclo.
2) Cronograma semanal (Semana 1‚Äì4).
3) Rotina de revis√£o espa√ßada (1-1-7-15).
4) Exerc√≠cios pr√°ticos.
5) Erros comuns e como evitar.

Recursos: listas e tabela simples em texto.
Regras: sem links.

Fecho: frase motivadora (2 linhas) + fontes (at√© 5).`,

      sustentacao: (tema) => `Voc√™ √© um **professor-orientador de Direito**.
Persona: colega did√°tico, r√°pido e claro.
Linguagem: simples e persuasiva.

Tarefa: Simule uma apresenta√ß√£o oral de at√© 4 minutos (~400‚Äì500 palavras) sobre **${tema}**.
Estrutura:
1) Abertura chamativa.
2) Contexto e relev√¢ncia jur√≠dica/social.
3) Desenvolvimento: defini√ß√£o, base legal, doutrina e jurisprud√™ncia segura, caso ilustrativo.
4) Argumenta√ß√£o persuasiva.
5) Fechamento forte.

Regras: sem links; cite enunciados/s√∫mulas s√≥ se 100% seguro.

Fecho: frase de impacto + fontes (at√© 5).`,

      jurisprudencia: (tema) => `Voc√™ √© um **jurista analista de jurisprud√™ncia**.
Persona: pesquisador criterioso, atualizado.
Linguagem: clara e t√©cnica.

Tarefa: Monte um radar de **jurisprud√™ncia** sobre **${tema}** com 15 itens verificados (tribunal, n¬∫/ano, tese resumida e impacto pr√°tico).
Regras:
- N√£o invente decis√µes.
- Use apenas fontes confi√°veis.
- Sem links se n√£o tiver certeza absoluta.
Sa√≠da: lista numerada de 15 itens.`
    };

    // ====== GERADOR: handlers ======
    const strategyEl=document.getElementById('strategy');
    const themeEl=document.getElementById('theme');
    const resultEl=document.getElementById('result');
    const btnGen=document.getElementById('generate');
    const btnCopy=document.getElementById('copy');
    const btnReset=document.getElementById('reset');

    function strategyHumanName(v){
      const map={
        explicacao:'Explica√ß√£o B√°sica',
        resumo:'Resumo Objetivo',
        artigo:'An√°lise Detalhada',
        aplicacao:'Aplica√ß√£o Pr√°tica',
        simulado:'Exerc√≠cios/Testes',
        faq:'FAQ',
        debate:'Debate/Reflex√£o',
        atualizacao:'Contexto Atualizado',
        plano:'Plano de Estudo',
        sustentacao:'Apresenta√ß√£o em Sala',
        jurisprudencia:'Jurisprud√™ncia'
      }; return map[v]||v;
    }

    function generate(){
      const s = strategyEl.value; const t = (themeEl.value||'').trim();
      if(!s){ alert('Selecione o objetivo.'); return; }
      if(!t){ alert('Digite o tema.'); themeEl.focus(); return; }
      const tpl = TEMPLATES[s];
      if(!tpl){ alert('Estrat√©gia inv√°lida. Atualize a p√°gina.'); return; }
      const out = tpl(t);
      resultEl.value = out;

      // Book local
      let bookData=[]; 
      try{ bookData = JSON.parse(localStorage.getItem('book_data_v1')||'[]'); if(!Array.isArray(bookData)) bookData=[]; }catch{ bookData=[]; }
      const entry = { objetivo: strategyHumanName(s), tema: t, prompt: out, ts: Date.now() };
      bookData.unshift(entry);
      if(bookData.length>500) bookData = bookData.slice(0,500);
      try{ localStorage.setItem('book_data_v1', JSON.stringify(bookData)); }catch{}

      if(document.getElementById('tab-book').classList.contains('is-active')){ clearBookUI(); renderBatch(); }
      window.scrollTo({top:document.body.scrollHeight, behavior:'smooth'});
    }

    async function copyOut(){
      if(!resultEl.value) return alert('Nada para copiar.');
      try{
        await navigator.clipboard.writeText(resultEl.value);
        const old = btnCopy.textContent; btnCopy.textContent='COPIADO'; btnCopy.disabled=true;
        setTimeout(()=>{ btnCopy.textContent=old; btnCopy.disabled=false; }, 1200);
      }catch{
        const ta = document.createElement('textarea'); ta.value = resultEl.value; ta.style.position='fixed'; ta.style.opacity='0';
        document.body.appendChild(ta); ta.focus(); ta.select();
        try{ document.execCommand('copy'); const old = btnCopy.textContent; btnCopy.textContent='COPIADO'; btnCopy.disabled=true; setTimeout(()=>{ btnCopy.textContent=old; btnCopy.disabled=false; }, 1200); }
        catch{ alert('N√£o foi poss√≠vel copiar.'); }
        finally{ document.body.removeChild(ta); }
      }
    }
    function resetAll(){ strategyEl.value=''; themeEl.value=''; resultEl.value=''; window.scrollTo({top:0,behavior:'smooth'}); }

    btnGen?.addEventListener('click', generate);
    btnCopy?.addEventListener('click', copyOut);
    btnReset?.addEventListener('click', resetAll);
    themeEl?.addEventListener('keydown', (e)=>{ if((e.ctrlKey||e.metaKey)&&e.key.toLowerCase()==='enter'){generate();}});

    // ===== Book (persist√™ncia local) =====
    const BOOK_KEY='book_data_v1';
    const PAGE_SIZE=10;
    let bookData=[]; let bookCursor=0; const bookWrap=document.getElementById('book-list');

    function loadBook(){ try{ bookData = JSON.parse(localStorage.getItem(BOOK_KEY)||'[]'); if(!Array.isArray(bookData)) bookData=[]; }catch{ bookData=[]; } }
    function truncate150(s){return (s||'').length>150?s.slice(0,150)+'‚Ä¶':s}
    function clearBookUI(){ if(bookWrap){ bookWrap.innerHTML=''; bookCursor=0; } }
    function renderBatch(){
      if(!bookWrap) return; const end=Math.min(bookCursor+PAGE_SIZE, bookData.length); const frag=document.createDocumentFragment();
      for(let i=bookCursor;i<end;i++){
        const {objetivo,tema,prompt}=bookData[i];
        const el=document.createElement('div'); el.className='book-item';
        el.innerHTML=`
          <div class="book-meta">
            <div class="book-obj">${objetivo||'‚Äî'}</div>
            <div class="book-tema">${truncate150(tema||'')}</div>
          </div>
          <div><button class="chipbtn" data-prompt="${String(prompt||'').replace(/"/g,'&quot;')}">Copiar</button></div>`;
        frag.appendChild(el);
      }
      bookWrap.appendChild(frag); bookCursor=end;
    }
    function onScroll(){
      if(!bookWrap) return;
      const near=bookWrap.scrollTop+bookWrap.clientHeight>=bookWrap.scrollHeight-8;
      if(near && bookCursor<bookData.length) renderBatch();
    }
    bookWrap?.addEventListener('scroll', onScroll);

    const _activate=activateTab;
    activateTab=function(id){
      _activate(id);
      if(id==='book'){
        if(!bookData.length){ loadBook(); }
        if(bookCursor===0){ renderBatch(); }
      }
    };

    // Bot√£o copiar dos cards
    document.addEventListener('click',async e=>{
      const btn=e.target.closest('.chipbtn'); if(!btn||!btn.dataset.prompt) return;
      try{
        await navigator.clipboard.writeText(btn.dataset.prompt);
        const old=btn.textContent; btn.textContent='Copiado!'; setTimeout(()=>btn.textContent=old,1000);
      }catch{ alert('N√£o foi poss√≠vel copiar.'); }
    });
  </script>
</body>
</html>
