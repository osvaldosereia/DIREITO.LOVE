<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
  <title>direito.love — Pesquisa</title>
  <meta name="theme-color" content="#F5C400" />

  <!-- SEO -->
  <meta name="description" content="Pesquisa de artigos, súmulas, jurisprudências e enunciados jurídicos no direito.love" />
  <meta name="keywords" content="pesquisa jurídica, direito, OAB, concursos, jurisprudência, súmulas" />
  <meta name="author" content="direito.love" />
  <meta name="robots" content="index, follow" />

  <!-- Favicon -->
  <link rel="icon" href="favicon.png" type="image/png" />
  <link rel="apple-touch-icon" href="favicon-180.png" />

  <style>
    :root{
      --bg:#FFFDF0; --surface:#ffffff; --text:#001840; --border:#e5e7eb;
      --primary:#102A71; --highlight:#F5C400; --highlight-light:#FFDC5F;
      --radius:10px; --shadow:0 4px 16px rgba(0,0,0,.05);
      --font:-apple-system,BlinkMacSystemFont,"Inter","Segoe UI",Roboto,system-ui,sans-serif;
    }
    *{box-sizing:border-box}
    body{margin:0;background:var(--bg);color:var(--text);font:400 13px/1.4 var(--font);}
    .topbar{position:sticky;top:0;z-index:30;background:var(--highlight);border-bottom:2px solid var(--primary);
      display:flex;justify-content:space-between;align-items:center;padding:4px 8%;}
    .topbar .logo a{text-decoration:none;cursor:default;display:inline-block;}
    .topbar .logo img{height:40px;width:auto}
    .nav-buttons{display:flex;gap:12px}
    .nav-buttons img{height:26px;width:26px;cursor:pointer;transition:transform .15s}
    .nav-buttons img:hover{transform:scale(1.1)}
    .wrap{max-width:900px;margin:0 auto;padding:22px}
    h2{margin:0 0 10px;color:var(--primary)}
    .search-box{margin:20px 0}
    #busca{width:100%;padding:10px 12px;border:2px solid var(--primary);border-radius:8px;font-size:15px}
    .result{background:var(--surface);border:1px solid var(--border);border-radius:var(--radius);box-shadow:var(--shadow);
      padding:12px 14px;margin:12px 0;position:relative}
    .result p{margin:0;font-size:13px;line-height:1.4}
    .actions{margin-top:8px;display:flex;justify-content:space-between;gap:8px}
    .btn{appearance:none;border:none;background:var(--highlight);color:#000;padding:6px 10px;border-radius:8px;
      font-size:13px;cursor:pointer;transition:.15s}
    .btn:hover{background:var(--highlight-light)}
    .btn-alt{appearance:none;border:none;background:var(--primary);color:#fff;padding:6px 10px;border-radius:8px;
      font-size:13px;cursor:pointer;transition:.15s}
    .btn-alt:hover{background:#264399}
    .toast{position:fixed;left:50%;transform:translateX(-50%);bottom:18px;background:#111;color:#fff;
      padding:8px 12px;border-radius:999px;opacity:0;transition:.2s;z-index:60}
    .toast.show{opacity:1}
  </style>
</head>
<body>
  <header class="topbar">
    <div class="logo"><a href="index.html"><img src="icons/logo.png" alt="direito.love"></a></div>
    <nav class="nav-buttons">
      <a href="index.html" aria-label="Início"><img src="icons/inicio.png" alt="Início"></a>
      <a href="pesquisa.html" aria-label="Pesquisar"><img src="icons/pesquisar.png" alt="Pesquisar"></a>
    </nav>
  </header>

  <div class="wrap">
    <h2>Pesquisa de Conteúdo Jurídico</h2>
    <p>Digite um termo (artigo, súmula, jurisprudência ou palavra-chave) para buscar nos arquivos.</p>
    <div class="search-box">
      <input id="busca" type="text" placeholder="Ex: artigo 5º, súmula 381, dano moral..." />
    </div>
    <div id="resultados"></div>
  </div>

  <div id="toast" class="toast"></div>

<script>
(function(){
  const $=(s,r=document)=>r.querySelector(s);
  const resultados=$("#resultados");
  const busca=$("#busca");
  const toast=(msg,t=1600)=>{const el=$("#toast");el.textContent=msg;el.classList.add("show");
    setTimeout(()=>el.classList.remove("show"),t);};

  // Agora só usa o JSON com id + texto
  const arquivos=["data/cp.json"];
  const arquivos=["data/cpp.json"];
  const arquivos=["data/jurisprudencia.json"];
  const arquivos=["data/cm.json"];

  async function carregarDados(){
    const dados=[];
    for(const arq of arquivos){
      try{
        const r=await fetch(arq); if(!r.ok) continue;
        const j=await r.json(); dados.push(...j);
      }catch(e){console.warn("Erro ao carregar",arq);}
    }
    return dados;
  }

  let baseDados=[];
  carregarDados().then(d=>{baseDados=d;toast("Base carregada com sucesso!")});

  function renderizarResultados(lista){
    resultados.innerHTML="";
    if(!lista.length){
      resultados.innerHTML="<p>Nenhum resultado encontrado.</p>";
      return;
    }

    lista.forEach(item=>{
      const div=document.createElement("div");
      div.className="result";

      // texto resumido (máx. 400 caracteres)
      const p=document.createElement("p");
      if(item.texto.length>400){
        p.textContent=item.texto.substring(0,400)+"...";
      }else{
        p.textContent=item.texto;
      }
      div.appendChild(p);

      // botões
      const actions=document.createElement("div");
      actions.className="actions";

      const copiar=document.createElement("button");
      copiar.textContent="Copiar";
      copiar.className="btn";
      copiar.addEventListener("click",async()=>{
        try{
          await navigator.clipboard.writeText(item.texto);
          toast("Copiado!");
        }catch{
          toast("Erro ao copiar.");
        }
      });

      const usarTema=document.createElement("button");
      usarTema.textContent="Usar Tema";
      usarTema.className="btn-alt";
      usarTema.addEventListener("click",()=>{
        localStorage.setItem("temaSelecionado", item.texto);
        window.location.href = "index.html";
      });

      actions.appendChild(copiar);
      actions.appendChild(usarTema);

      div.appendChild(actions);
      resultados.appendChild(div);
    });
  }

  busca.addEventListener("input",()=>{
    const termo=busca.value.toLowerCase().trim();
    if(!termo){resultados.innerHTML="";return;}
    const achados=baseDados.filter(x=>
      x.texto && x.texto.toLowerCase().includes(termo)
    );
    renderizarResultados(achados);
  });
})();
</script>
</body>
</html>
